OIDC login flow by Dex using Authorization Code flow
===============================

## Diagram
```

                                                                (8)
                                                 +-----------------------------------+
                                  (10)           |              (7)                  |
                        +---------------------+  |   +---------------------------+   |
                        |                     |  |   |                           |   |
+----------+       +----+---+      (2)      +-v--v---+--+       (3)         +----v---+----+
|          |  (1)  |        +--------------->           +------------------->             |
|   End -  +-------> Client |      (9)      |    DEX    |       (6)         | OIDC SERVER +-----+
|   User   |       |        <---------------+           <-------------------+             |     |
|          |       +----^---+               +-----+-----+                   +-------------+     |
+----+-----+            |          (11)           |                                             | (4)
     |                  +-------------------------+                         +-------------+     |
     |                                                                      |             |     |
     |                               (5)                                    | OIDC SERVER |     |
     +---------------------------------------------------------------------->             <-----+
                                                                            |    LOGIN    |
                                                                            |             |
                                                                            +-------------+

```
__(1)__ End-User connects to registered client in Dex

__(2)__ Client connects to Dex to authenticate End-User, so the client sends its client_id, redirect_uri, response_type and scopes. 

Example:
`http(s)://host:port/auth?client_id=client_id&redirect_uri=https://hostClientRedirect/callback&response_type=code&scope=openid+email+profile&state=`

__(3)__ Dex connects to OIDC SERVER with its client_id, redirect_uri, response_type and scopes like in step 2 and creates a new unique session with state `NEW`. This session changes to `REMOTE_ATTACHED` when user select the OIDC connector.

__(4)__ OIDC server generate a code for this session and redirect End-User to its authetication page.

__(5)__ End-User enters their credentials and if login is succesful it goes to step 6 

__(6)__ OIDC server redirects End-User to Dex redirect uri which is `http(s)://host:port/auth/(connector)/callback` with the code generated by OIDC server.

__(7)__ Dex exchanges received code for an access token sending next data:

__Header__
* `client_id` and `client secret` separated by "`:`" and encoded with base64 encoding in `Authorization` header.

__Post form__
* `grant_type` which value is code
* `code` which value is the code retrieved

__(8)__ OIDC server sends Access token according to parameters received in step 7.

__(9)__ Dex retrieve Access token, verifies JWT and changes session status to `IDENTIFIED`. Then redirect End-User to client callback with a new session code to exchange Acces token. 

__(10)__ Client retrieves the code and sends it with its client credentials to retrieve an Access token.

__(11)__ Dex checks clients credentials retrieved and code, then generate an Access token associated to the user that autenticates in step 5, changes session status to `EXCHANGED` and sends it to client.

When client has an Access token it can use it to request resources from Resource Server 
